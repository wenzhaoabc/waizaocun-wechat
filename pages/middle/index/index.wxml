<view capture-bind:touchend="canselSearch" class="map-container">
  <view class="map-content map-content-show">
    <map class="map"
      markers="{{siteMakers}}" 
      latitude="{{location.latitude}}" 
      longitude="{{location.longitude}}" 
      scale="{{mapScale}}" 
      min-scale="{{minScale}}"
      max-scale="{{maxScale}}" 
      enable-satellite="{{satellite}}" 
      show-location="{{true}}" 
      bindmarkertap="onChangeCurrentSite" 
      bindcallouttap="onChangeCurrentSite">
      <!-- å«æ˜Ÿå›¾/æ ‡å‡†åœ°å›¾åˆ‡æ¢ -->
      <cover-image 
        src="{{mapFormIcon}}" 
        class="control-btn control-btn-mapform" 
        bindtap="onChangeMapForm" />
      <!-- æ”¾å¤§æŒ‰é’® -->
      <cover-image 
        hidden="{{toSearch||toDetail}}" 
        src="{{imgs.plus}}" 
        class="control-btn control-btn-increase" 
        bindtap="onIncreaseScale" />
      <!-- ç¼©å°æŒ‰é’® -->
      <cover-image 
        hidden="{{toSearch||toDetail}}" 
        src="{{imgs.minus}}" 
        class="control-btn control-btn-decrease" 
        bindtap="onDecreaseScale" />
    </map>
  </view>
</view>

<view wx:if="{{!toSearch}}" class="float-bottom">
  <view class="cu-bar search-box">
    <view class="search-form round text-xxl" 
      style="height: 80rpx;background-color: #fff;" 
      bindtap="gotoSearch">
      <text class="cuIcon-search"></text>
      <view>
        <text>æœç´¢é™„è¿‘ç‚¹ä½</text>
      </view>
    </view>
  </view>
  <view>
    <view class="btn-row padding-tb-xl">
      <view class="btn-item" bindtap="onRouteToThree">
        <view class="btn-icon">
          <image src="../../../images/middle/cunshe.png"></image>
        </view>
        <text class="btn-text">æ‘èˆ</text>
      </view>
      <view class="btn-item">
        <view class="btn-icon">
          <image src="../../../images/middle/heliu.png"></image>
        </view>
        <text class="btn-text">æ²³æµ</text>
      </view>
      <view class="btn-item">
        <view class="btn-icon">
          <image src="../../../images/middle/yuwoxiangguan.png"></image>
        </view>
        <text class="btn-text">æˆ‘çš„</text>
      </view>
      <view class="btn-item" bindtap="onFeedBack">
        <view class="btn-icon">
          <image src="../../../images/middle/fankui.png"></image>
        </view>
        <text class="btn-text">æ–°å¢</text>
      </view>
    </view>
  </view>
</view>

<view hidden="{{!toSearch}}" class="search">
  <view>
    <!-- æœç´¢æ¡† -->
    <input type="text" 
      placeholder="è¯·è¾“å…¥è¦æœç´¢çš„ç‚¹ä½åç§°" 
      bindinput="inputtoSearch" 
      confirm-type="search" />
    <view class="">
      <icon type="search" class="search-icon"></icon>
    </view>
    <view class="">
      <text class="search-text">æœç´¢</text>
    </view>
  </view>
  <scroll-view scroll-y="{{true}}">
    <view class="cu-list menu">
      <view 
        wx:for="{{searchResSitesInfo}}" 
        wx:key="index" 
        class="cu-item sm-border" 
        bindtap="gotoSiteDetail" 
        data-site="{{item}}">
        <view class="content">
          <text class="cuIcon-location text-green"></text>
          <text class="text-grey text-xl">{{item.title}}</text>
        </view>
        <view class="action">
          <text class="text-grey text-sm">{{item.publisher}}</text>
        </view>
      </view>
    </view>
  </scroll-view>
</view>


<view hidden="{{!(!toSearch&&toDetail)}}" class="sitedetail">
  <scroll-view scroll-y="true" style="height: 100%; padding-top: 20rpx;">
    <view class="cu-card case no-card margin-top-sm">
      <view class="cu-item shadow">
        <view class="image">
          <image src="{{currentSiteInfo.imgurl}}" mode="scaleToFill"></image>
          <view class="cu-tag bg-blue">æ ‡ç­¾</view>
        </view>
        <view class="cu-list menu">
          <view class="cu-item">
            <view class="content flex-sub">
              <view class="text-black text-xl">{{currentSiteInfo.title}}</view>
              <view class="text-gray text-sm flex justify-between">
                {{currentSiteInfo.publisher}} Â· {{currentSiteInfo.publishtime}}
              </view>
              <view class="text-black text-l">
                è¯¦æƒ…ï¼š
                {{currentSiteInfo.detail}}
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
    <view class="padding flex flex-direction bg-white">
      <button class="cu-btn bg-green lg" bindtap="onStartDesign">è®¾è®¡</button>
    </view>
    <view class="cu-list menu-avatar comment solids-top">
      <view class="cu-bar input">
        <view class="action">
          <text class="cuIcon-write text-grey"></text>
        </view>
        <input 
          class="solid-bottom" 
          adjust-position="{{false}}" 
          focus="{{false}}" 
          maxlength="300" 
          cursor-spacing="10" 
          value="{{content}}" 
          bindinput="getInputVal" 
          placeholder="è¯´ç‚¹ä»€ä¹ˆ..." />

        <button class="cu-btn bg-green shadow" bindtap="sendReview">å‘å¸ƒ</button>
      </view>
      <view wx:for="{{reviewList}}" wx:key="reviewID" class="cu-item">
        <view 
          class="cu-avatar round" 
          style="background-image:url({{item.headPhoto}});"></view>
        <view class="content">
          <view class="text-grey">{{item.userName}}</view>
          <view class="text-gray text-content text-df">
            {{item.content}}
          </view>
          <view class="margin-top-sm flex justify-between">
            <view class="text-gray text-df">{{item.date}}</view>
            <view>
              <text class="cuIcon-appreciatefill {{item.isHelpful?'text-red':'text-gray'}}"></text>
              <text class="cuIcon-messagefill {{item.isLoved?'text-red':'text-gray'}} margin-left-sm"></text>
            </view>
          </view>
        </view>
      </view>
      <view class="cu-item">
        <view 
          class="cu-avatar round" 
          style="background-image:url(https://ossweb-img.qq.com/images/lol/img/champion/Morgana.png);"></view>
        <view class="content">
          <view class="text-grey">ææ—é£</view>
          <view class="text-gray text-content text-df">
            ç¾ä¸½å¤–ç¶äººäººå…±å»ºï¼
          </view>
          <view class="margin-top-sm flex justify-between">
            <view class="text-gray text-df">2022å¹´11æœˆ4æ—¥</view>
            <view>
              <text class="cuIcon-appreciatefill text-red"></text>
              <text class="cuIcon-messagefill text-gray margin-left-sm"></text>
            </view>
          </view>
        </view>
      </view>
      <view class="cu-item">
        <view class="cu-avatar round" style="background-image:url(https://ossweb-img.qq.com/images/lol/web201310/skin/big10006.jpg);"></view>
        <view class="content">
          <view class="text-grey">å²³ç–é¸¿</view>
          <view class="text-gray text-content text-df">
            æµ´ä¹æ²‚ï¼Œé£ä¹èˆé›©ï¼Œå’è€Œå½’ã€‚æ˜¯æˆ‘å‘å¾€çš„ç”Ÿæ´»ğŸ˜ƒ
          </view>
          <view class="margin-top-sm flex justify-between">
            <view class="text-gray text-df">2022å¹´10æœˆ29æ—¥</view>
            <view>
              <text class="cuIcon-appreciate text-gray"></text>
              <text class="cuIcon-messagefill text-gray margin-left-sm"></text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </scroll-view>
</view>

